<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="694px" preserveAspectRatio="none" style="width:861px;height:694px;background:#FFFFFF;" version="1.1" viewBox="0 0 861 694" width="861px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="322" x="268" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="312" x="273" y="27.9951">Owner set up policy (management app)</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="101" x2="101" y1="73.5938" y2="659.3828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="243.5" x2="243.5" y1="73.5938" y2="659.3828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="407" x2="407" y1="73.5938" y2="659.3828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="494" x2="494" y1="73.5938" y2="659.3828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="665.5" x2="665.5" y1="73.5938" y2="659.3828"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="63" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="70" y="62.292">AppLogic</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="63" y="658.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="70" y="678.3779">AppLogic</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="210.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="217.5" y="62.292">SolidLib</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="210.5" y="658.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="217.5" y="678.3779">SolidLib</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="37" x="389" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23" x="396" y="62.292">IDP</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="37" x="389" y="658.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23" x="396" y="678.3779">IDP</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="436" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="443" y="62.292">AdminInterface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="436" y="658.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="443" y="678.3779">AdminInterface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="607.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="614.5" y="62.292">AuthZInterface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="607.5" y="658.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="614.5" y="678.3779">AuthZInterface</text><polygon fill="#181818" points="231.5,100.7266,241.5,104.7266,231.5,108.7266,235.5,104.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="101.5" x2="237.5" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="108.5" y="99.6606">Login (IDP?)</text><polygon fill="#181818" points="395.5,129.8594,405.5,133.8594,395.5,137.8594,399.5,133.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="401.5" y1="133.8594" y2="133.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="250.5" y="128.7935">LoginRedirect(IDP)</text><polygon fill="#181818" points="254.5,158.9922,244.5,162.9922,254.5,166.9922,250.5,162.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.5" x2="406.5" y1="162.9922" y2="162.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="260.5" y="157.9263">Redirect(TokenAuthN)</text><polygon fill="#181818" points="112.5,188.125,102.5,192.125,112.5,196.125,108.5,192.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="106.5" x2="242.5" y1="192.125" y2="192.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="118.5" y="187.0591">LoggedIn(Session)</text><path d="M60,205.125 L60,230.125 L427,230.125 L427,215.125 L417,205.125 L60,205.125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M417,205.125 L417,215.125 L427,215.125 L417,205.125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346" x="66" y="222.1919">Lib knows WebID, client, issuer, well knowns, endpoints</text><path d="M5,240.2578 L5,280.2578 L198,280.2578 L198,250.2578 L188,240.2578 L5,240.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M188,240.2578 L188,250.2578 L198,250.2578 L188,240.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="11" y="257.3247">There exists a policy</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="11" y="272.4575">The owner wants to store it</text><polygon fill="#181818" points="231.5,302.6563,241.5,306.6563,231.5,310.6563,235.5,306.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="101.5" x2="237.5" y1="306.6563" y2="306.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="108.5" y="301.5903">AddPolicy(policy)</text><polygon fill="#181818" points="482.5,331.7891,492.5,335.7891,482.5,339.7891,486.5,335.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="488.5" y1="335.7891" y2="335.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="250.5" y="330.7231">AddPolicy(?Authn Token?, policy)</text><polygon fill="#181818" points="254.5,360.9219,244.5,364.9219,254.5,368.9219,250.5,364.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.5" x2="493.5" y1="364.9219" y2="364.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="260.5" y="359.856">No Authz Token</text><polygon fill="#181818" points="653.5,390.0547,663.5,394.0547,653.5,398.0547,657.5,394.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="659.5" y1="394.0547" y2="394.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398" x="250.5" y="388.9888">requestAuthz(subject: AuthNToken, action: addPolicy, res: Pol)</text><polygon fill="#181818" points="254.5,419.1875,244.5,423.1875,254.5,427.1875,250.5,423.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.5" x2="664.5" y1="423.1875" y2="423.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="260.5" y="418.1216">return authZ Token</text><path d="M476,436.1875 L476,476.1875 L854,476.1875 L854,446.1875 L844,436.1875 L476,436.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M844,436.1875 L844,446.1875 L854,446.1875 L844,436.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="482" y="453.2544">Internal vs External</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="482" y="468.3872">External allows for checking extra claims, negotiation, ...</text><polygon fill="#181818" points="482.5,498.5859,492.5,502.5859,482.5,506.5859,486.5,502.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="488.5" y1="502.5859" y2="502.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="250.5" y="497.52">AddPolicy(AuthZ Token, policy)</text><path d="M412,515.5859 L412,585.5859 L576,585.5859 L576,525.5859 L566,515.5859 L412,515.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M566,515.5859 L566,525.5859 L576,525.5859 L566,515.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="418" y="532.6528">Mock adding policy</text><ellipse cx="423.5" cy="543.3516" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="429" y="547.7856">add Policy in storage</text><ellipse cx="423.5" cy="558.4844" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="429" y="562.9185">Integrity constraints</text><ellipse cx="423.5" cy="573.6172" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="429" y="578.0513">Conflict Resolution</text><polygon fill="#181818" points="254.5,608.25,244.5,612.25,254.5,616.25,250.5,612.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="248.5" x2="493.5" y1="612.25" y2="612.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="260.5" y="607.1841">return OK</text><polygon fill="#181818" points="112.5,637.3828,102.5,641.3828,112.5,645.3828,108.5,641.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="106.5" x2="242.5" y1="641.3828" y2="641.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="118.5" y="636.3169">return OK</text><!--MD5=[c814db004a7dea18e05b5a26f023f0b0]
@startuml
title Owner set up policy (management app)


participant AppLogic
participant SolidLib

participant IDP

participant AdminInterface
participant AuthZInterface

AppLogic->SolidLib: Login (IDP?)
SolidLib->IDP: LoginRedirect(IDP)
IDP->SolidLib: Redirect(TokenAuthN)
SolidLib->AppLogic: LoggedIn(Session)
note over SolidLib: Lib knows WebID, client, issuer, well knowns, endpoints

note over AppLogic: There exists a policy\nThe owner wants to store it

AppLogic->SolidLib: AddPolicy(policy)
SolidLib->AdminInterface: AddPolicy(?Authn Token?, policy)
AdminInterface->SolidLib: No Authz Token

SolidLib->AuthZInterface: requestAuthz(subject: AuthNToken, action: addPolicy, res: Pol)
AuthZInterface->SolidLib: return authZ Token
note over AuthZInterface: Internal vs External\nExternal allows for checking extra claims, negotiation, ...

SolidLib->AdminInterface: AddPolicy(AuthZ Token, policy)
note over AdminInterface:Mock adding policy\n* add Policy in storage\n* Integrity constraints\n* Conflict Resolution
AdminInterface->SolidLib: return OK
SolidLib->AppLogic: return OK
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>